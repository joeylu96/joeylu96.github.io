---
title: 存储管理_1
author: joeylu
date: 2020-12-21 21:20:00 +0800
categories: [学习, 操作系统]
tags: [操作系统]
toc: false
---
# 存储管理
**1.存储管理概述:**  
&ensp;&ensp;&ensp;&ensp;存储器由内存和外存组成。内存由顺序编址的块组成，每块包含相应的物理单元。
外存是指指除计算机内存及CPU缓存以外的储存器。内存用于存放那些立即要用的程序和数据；外存用于存放暂时不用的程序和数据。
CPU要通过启动相应的输入输出设备才能让内存与外存之间交换信息。  

**2.存储管理的功能:**  
&ensp;&ensp;&ensp;&ensp;下面介绍存储管理的功能：  
&ensp;&ensp;&ensp;&ensp;1.虚拟存储器：编译链接程序把用户源程序编译后链接到一个以0地址为始地址的线性或多维虚拟地址空间。
每个指令或数据单元都在这个虚拟空间中拥有确定的地址，此为虚拟地址。每个进程都有这样一个空间，其排序可以是非连续的，其实际
物理地址由虚拟地址变换得到。这些虚拟地址组成的空间称为虚拟存储器。<b>虚拟存储器是一个在物理上只受内存和外存总容量限制的存储系统</b>。  

&ensp;&ensp;&ensp;&ensp;2.地址变换：内存地址的集合为内存空间或物理地址空间。在内存中，每一个存储单元都有与之对应的内存地址，
内存为一维线性的。将虚拟地址映射为内存地址称之为地址的重定位或地址映射。具体分为两种，一是静态地址重定位，虚拟空间程序
执行前由装配程序完成地址映射工作，它无法实现虚拟存储器，因为静态重定位是在程序执行前就将有关部分全部装入内存并不能再移动；
二是动态地址重定位，程序执行过程中，在CPU访问内存之前，将要访问的程序或数据地址转换为内存地址。  

&ensp;&ensp;&ensp;&ensp;3.内外存数据传输的控制：把即将执行的程序和数据段调入内存，而把那些处于等待状态的程序和数据段调出内存。
控制办法分为：一用户自己控制，覆盖，根据顺序调入内存，但最大长度仍受内存影响。二操作系统控制，交换和请求调入，交换是指操作系统
将内存中处于等待状态的进程换出内存，而把已经发生或处于就绪状态的进程换入内存；请求调入就是进程执行中，将不在内存的数据和程序段调入内存。  

&ensp;&ensp;&ensp;&ensp;4.内存的分配与回收：外存的数据能否调入内存，以及调入的位置，进程执行结束时要及时回收该进程所占用的内存。  

&ensp;&ensp;&ensp;&ensp;5.内存信息的共享与保护：上下界保护法，要求每个进程设置一个上下界寄存器，进程中内存访问时检测地址合法性，属于硬件保护法。
保护键法，读写保护之类的键值存入程序状态字。还可以将两者结合。  

**3.分区存储管理:**  
&ensp;&ensp;&ensp;&ensp;分区管理的基本原理是给每一个内存中的进程分划一块适当大小的存储区，以连续存储各进程的程序和数据。分区分为固定分区法
和东莞太分区法，区别在于内存分配的时间是否在作业执行前，之前则为固定，处理过程中建立分区则为动态分区。动态分区中将内存中的可用分区单独构成
可用分区表(区号，分区大小和分区起址)或可用分区自由链（存储分区大小，起址和下个分区的起址）以描述系统内的内存资源，同时请求也构成了一个资源请求表。
动态分区有最先、最佳和最坏三种适应算法，请求资源大小最先匹配到可用表或链的某个分区即为最先，表或链按从小到大顺序遍历取到合适则为最佳，反之为最坏。
分区存储功能无法实现用户进程所需内存容量只受内外存容量之和限制的虚拟存储器。  

**4.页式管理:**  
&ensp;&ensp;&ensp;&ensp;页式管理是指各进程的虚拟空间被划分为若干个长度相等的页。页长的划分和内外存之间的数据传输速度以及内存大小有关。  
&ensp;&ensp;&ensp;&ensp;页的结构为：页表，请求表和存储页面表。页表在内存中占有一个块固定的存储区，大小由进程或作业的长度决定，记录页号和页面号。
请求表用来确定作业或进程的虚拟空间的各页在内存中实际对应的位置。存储页面表为整个系统一张，存储页面表中的各页面是非被分配，以及未分配的页数。  
![joey 图标](/assets/img/sample/4_1.jpg)  
![joey 图标](/assets/img/sample/4_2.jpg)  


&ensp;&ensp;&ensp;&ensp;页式管理也分静态和动态，区分原理和分区相似。动态页式管理中，请求页式管理会遇到页面不在内存中的问题，因此需要增设该页是否
在内存的中断位和该页外存中的副本起始地址，同时需要考虑如何将缺页调入内存，以及若内存中无空闲，如何淘汰其他已占内存的页。综上，请求页式管理有以下几
种置换算法：1.随机淘汰法 2.轮转法和先进先出法 3.最近最久未使用。页式管理的存储保护分为两种，一是地址越界保护，二是通过页表控制对内存信息的存取操作方式以提供保护。  

**5.段式与段页式管理:**  
&ensp;&ensp;&ensp;&ensp;段式管理的基本思想是把程序按内容或过程（函数）关系分成段，每个段有自己的名字。一个用户作业或进程所包含的段对应一个二维
线性虚拟空间，也就是一个二维虚拟存储器。段式管理程序以段为单位分配内存，然后通过地址映射机构把段式虚拟地址转换成实际的内存物理地址。段式结构包含以下
几个内容：段表，动态地址变换。段表和页式管理相似，程序初始化内存分配之前，建立一个段表，记录段号，起址，长度，存取方式，内外存和访问位，内外存决定是否发生中断，
访问位根据淘汰算法需要而设。动态地址变化则是指产生缺段中断时，将CPU控制权交给内存分配程序来进行分配。段式管理中，虚存的每次交换都是一段有意义的信息，而不像
页，只能是固定大小的页，段长也可以动态增长，便于对完整逻辑功能的信息段进行共享。  

&ensp;&ensp;&ensp;&ensp;段页式管理：一个进程拥有自己的二维地址空间，进程中具有独立功能的程序或数据被划分为段，并有自己的段号，其次每个段中的程序和数据
按一定大小分为不同的页。  

